#  ____   ____ __  __ 
# |  _ \ / ___|  \/  |
# | | | | |   | |\/| | This compose file was generated by DCM: https://github.com/ajnart/dcm
# | |_| | |___| |  | |
# |____/ \____|_|  |_|
#
services:

  # Grafana: The open and composable observability and data visualization platform. Visualize metrics, logs, and traces from multiple sources.
  grafana:
    image: grafana/grafana-enterprise
    container_name: ${CONTAINER_PREFIX}grafana
    ports:
      - "3000:3000"
    volumes:
      - ${DATA_PATH}/grafana:/var/lib/grafana
      - ${CONFIG_PATH}/grafana/provisioning:/etc/grafana/provisioning
    environment:
      - GF_SECURITY_ADMIN_USER=admin
      - GF_SECURITY_ADMIN_PASSWORD=your_password
      - GF_USERS_ALLOW_SIGN_UP=false
      - GF_PLUGINS_PREINSTALL=grafana-clock-panel
      - TZ=${TZ}
    restart: ${RESTART_POLICY}
    labels:
     - homepage.group=Analytics
     - homepage.name=Grafana
     - homepage.icon=grafana.png
     - homepage.href=https://grafana.rjester.us/
     - homepage.description=Grafana
     - traefik.enable=true
     - traefik.http.routers.grafana.rule=Host(`grafana.rjester.us`)
     - traefik.http.routers.grafana.entrypoints=https
     - traefik.http.routers.grafana.tls=true
     - traefik.http.services.grafana.loadbalancer.server.port=3000

  # Prometheus: A powerful monitoring and alerting toolkit designed for reliability. Features include a multi-dimensional data model, flexible query language (PromQL), efficient time series database, and modern alerting approach.
  prometheus:
    image: prom/prometheus:latest
    container_name: ${CONTAINER_PREFIX}prometheus
    volumes:
      - ${CONFIG_PATH}/prometheus:/etc/prometheus
      - ${DATA_PATH}/prometheus:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--web.console.libraries=/usr/share/prometheus/console_libraries'
      - '--web.console.templates=/usr/share/prometheus/consoles'
    ports:
      - "9090:9090"
    environment:
      - TZ=${TZ}
    restart: ${RESTART_POLICY}
    labels:
     - homepage.group=Analytics
     - homepage.name=Prometheus
     - homepage.icon=prometheus.png
     - homepage.href=https://prometheus.rjester.us/
     - homepage.description=Prometheus
     - traefik.enable=true
     - traefik.http.routers.prometheus.rule=Host(`prometheus.rjester.us`)
     - traefik.http.routers.prometheus.entrypoints=https
     - traefik.http.routers.prometheus.tls=true
     - traefik.http.services.prometheus.loadbalancer.server.port=9090
